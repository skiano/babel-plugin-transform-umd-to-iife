/** @license https://github.com/skiano/predication/blob/master/LICENSE */
!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(n.predication=n.predication||{})}(this,function(n){"use strict";var t=function(n,t){return!1===t(n)},r=function(n,t){return t.every(function(t){return t(n)})},e=function(n,t){return t.some(function(t){return t(n)})},u=function(n){return function(t){return typeof t===n}},i=function(n){throw new Error(n)},o=function(n){return Array.isArray(n)},c=u("boolean"),f=u("string"),a=u("number"),d=u("function"),s=u("undefined"),l=function(n){return!s(n)},v=function(n,t){return function(r){return o(r)&&r.length===n&&(!t||r.every(t))}},p=function(n,t){return n.toLowerCase().includes(t.toLowerCase())},h=function(n,t){return f(n)?p(n,t):o(n)?n.includes(t):void 0},g=function(n,t){return n%t==0},y=function(n,t){var r=t[0];return n%r==t[1]%r},b=function(n){var t=typeof n;return"object"===t&&!o(n)&&"function"!==t&&!!n},m=function(n,t){return f(n)&&p(n,t)||b(n)&&Object.keys(n).some(function(r){return m(n[r],t)})||o(n)&&n.some(function(n){return m(n,t)})||!1},P={},x={},j=function(n,t,r){return"exists"!==n&&(s(r)||s(t))},k=function(){return Object.keys(P)},w=function(n){return P.hasOwnProperty(n)},O=function(n){delete P[n],delete x[n]},A=function(n,t,r){w(n)?i('Predicate "'+n+'" is already registered'):(x[n]=r,P[n]=function(e,u,i,o){var c=i(u),f=o?o(u):e;if(!(j(n,c,f)||o&&r&&!r(f)))return t(c,f)})},E=function(n,t,r){if(w(n)){var e=b(t)&&t.that;e||!x[n]||x[n](t)||i('invalid config for "'+n+'": '+t);var u=M(r),o=e&&M(t.that);return function(r){return P[n](t,r,u,o)}}i(n?'Unregisterd predicate: "'+n+'"':"Empty predicate")};A("not",t),A("and",r),A("or",e),A("exists",function(n,t){return t===!s(n)},c),A("mod",function(n,t){return o(t)?y(n,t):g(n,t)},function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return function(t){return e(t,n)}}(a,v(2,a))),A("in",function(n,t){return h(n,t)},l),A("nin",function(n,t){return!h(n,t)},l),A("eq",function(n,t){return n===t},l),A("ne",function(n,t){return n!==t},l),A("lt",function(n,t){return n<t},a),A("gt",function(n,t){return n>t},a),A("lte",function(n,t){return n<=t},a),A("gte",function(n,t){return n>=t},a),A("rng",function(n,t){return n>=t[0]&&n<=t[1]},v(2,a)),A("oi",function(n,t){return m(n,t)},f),A("noi",function(n,t){return!m(n,t)},f);var C=/^([^\[]*)\[(\-?\d*)\]$/,L=/^(\-?)(\d)$/,$=function(n,t){return o(n)?n[t]:f(n)?n.charAt(t):void 0},_=function(n){var t=L.exec(n),r=t[1],e=t[2];return function(n){return $(n,r?n.length-e-1:e)}},q=function(n){return n},M=function(n){if(s(n))return q;f(n)&&n||i("bad access path: "+n);var t=n.split(".").reduce(function(n,t){var r=C.exec(t);return r?n.concat(r[1]?[r[1],_(r[2])]:_(r[2])):n.concat([t])},[]);return 0===t.length?q:function(n){if(!s(n)&&null!==n){for(var r=n,e=0;e<t.length;e+=1){if(s(r))return;r=d(t[e])?t[e](r):r[t[e]]}return r}}},U=function(n){return"this"!==n},z=function(n,t){void 0===t&&(t=!1);var r,e,u=Object.keys(n).filter(U),o=u[0],c=n.this;switch(!0){case u.length>1:e=function(t){return z((r={},r[t]=n[t],r),!0);var r},r=E("or",u.map(e),c);break;case"and"===o||"or"===o:0===n[o].length&&i("Empty logic"),e=function(n){return z(n,!0)},r=E(o,n[o].map(e),c);break;case"not"===o:r=E(o,z(n[o],!0),c);break;default:r=E(o,n[o],c)}return t?r:function(n){return!!r(n)}};n.listPredicates=k,n.hasPredicate=w,n.removePredicate=O,n.registerPredicate=A,n.getPredicate=E,n.evaluation=M,n.predication=z,Object.defineProperty(n,"__esModule",{value:!0})});
